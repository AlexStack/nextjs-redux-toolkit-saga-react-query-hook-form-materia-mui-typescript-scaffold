{"type_of":"article","id":1241348,"title":"Need help ! Issue with Auto Scaling for Application Load Balancer with 2 different instances for target groups","description":"What is your question/issue (provide as much detail as possible)?  Hi All, I currently have an...","readable_publish_date":"Nov 3","slug":"need-help-issue-with-auto-scaling-for-application-load-balancer-with-2-different-instances-for-target-groups-gp0","path":"/deborahcat/need-help-issue-with-auto-scaling-for-application-load-balancer-with-2-different-instances-for-target-groups-gp0","url":"https://dev.to/deborahcat/need-help-issue-with-auto-scaling-for-application-load-balancer-with-2-different-instances-for-target-groups-gp0","comments_count":0,"public_reactions_count":0,"collection_id":null,"published_timestamp":"2022-11-03T08:03:06Z","positive_reactions_count":0,"cover_image":null,"social_image":"https://dev.to/social_previews/article/1241348.png","canonical_url":"https://dev.to/deborahcat/need-help-issue-with-auto-scaling-for-application-load-balancer-with-2-different-instances-for-target-groups-gp0","created_at":"2022-11-03T08:01:36Z","edited_at":null,"crossposted_at":null,"published_at":"2022-11-03T08:03:06Z","last_comment_at":"2022-11-03T08:03:06Z","reading_time_minutes":2,"tag_list":"help, aws, ec2","tags":["help","aws","ec2"],"body_html":"<p>What is your question/issue (provide as much detail as possible)?</p>\n\n<p>Hi All, I currently have an Application Load Balancer that has two rules :</p>\n\n<p>If the request is coming from a specific path Example: /test/, use a target group that points to an instance ( Let's say instance b ). For any other request use this target group ( another instance a ) In the autoscaling settings I have added these two target groups so that if autoscaling occurs and terminates the instances, they will be re-registered. This works correctly, however, I noticed that when termination happens the target group registers instance a where only instance b needs to be registered.</p>\n\n<p>I do have 2 ASGs, one for the instance a and one for another instance b. However, I mostly use the main site Load balancer as the rules are located there ( if the path of /test/* it uses the instance b ( target group ). The reason this was set like this is that the instance b is accessed by the main site domain. ( For example <a href=\"http://www.example.com/test\">www.example.com/test</a> ) The desired count is set to 1.<br>\nSince I'm using the ALB of the main site only when the ASG terminates the instance, a new target is registered for the main site in the target group of the instance b. My issue is that this target group should only register one instance and not 2 ( instance a ( main site ) and instance b )</p>\n\n<p>Would really appreciate some guidance, haven't received much from Re:post :(</p>\n\n<p>What technologies are you using?</p>\n\n<p>AWS, AutoScaling, EC2, ElasticBeanstalk</p>\n\n<p>What were you expecting to happen?</p>\n\n<p>When Autoscaling terminates the instance, the target group that has instance b registers, initiates another instance and places the same instance b and not another instance a. </p>\n\n<p>What is actually happening?</p>\n\n<p>When Autoscaling terminates the instance, the target group is adding another instance a and therefore the site breaks as the incorrect server is being shown.</p>\n\n<p>What have you already tried/thought about?</p>\n\n<p>Maybe having one autoscaling group for two different instances, however didn't manage. But there is still the issue of cannot control which instance is added to the target group when its terminated.</p>\n\n","body_markdown":"\n\nWhat is your question/issue (provide as much detail as possible)?\n\nHi All, I currently have an Application Load Balancer that has two rules :\n\nIf the request is coming from a specific path Example: /test/, use a target group that points to an instance ( Let's say instance b ). For any other request use this target group ( another instance a ) In the autoscaling settings I have added these two target groups so that if autoscaling occurs and terminates the instances, they will be re-registered. This works correctly, however, I noticed that when termination happens the target group registers instance a where only instance b needs to be registered.\n\nI do have 2 ASGs, one for the instance a and one for another instance b. However, I mostly use the main site Load balancer as the rules are located there ( if the path of /test/* it uses the instance b ( target group ). The reason this was set like this is that the instance b is accessed by the main site domain. ( For example www.example.com/test ) The desired count is set to 1.\nSince I'm using the ALB of the main site only when the ASG terminates the instance, a new target is registered for the main site in the target group of the instance b. My issue is that this target group should only register one instance and not 2 ( instance a ( main site ) and instance b )\n\nWould really appreciate some guidance, haven't received much from Re:post :(\n\nWhat technologies are you using?\n\nAWS, AutoScaling, EC2, ElasticBeanstalk\n\nWhat were you expecting to happen?\n\nWhen Autoscaling terminates the instance, the target group that has instance b registers, initiates another instance and places the same instance b and not another instance a. \n\nWhat is actually happening?\n\nWhen Autoscaling terminates the instance, the target group is adding another instance a and therefore the site breaks as the incorrect server is being shown.\n\nWhat have you already tried/thought about?\n\nMaybe having one autoscaling group for two different instances, however didn't manage. But there is still the issue of cannot control which instance is added to the target group when its terminated.\n","user":{"name":"deborah-Cat","username":"deborahcat","twitter_username":null,"github_username":"deborah-Cat","user_id":938078,"website_url":null,"profile_image":"https://res.cloudinary.com/practicaldev/image/fetch/s--gz4QkxLK--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/938078/0b988fcb-72f8-4a0c-a1ce-b9e16426cbfb.png","profile_image_90":"https://res.cloudinary.com/practicaldev/image/fetch/s--iduZIaiB--/c_fill,f_auto,fl_progressive,h_90,q_auto,w_90/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/938078/0b988fcb-72f8-4a0c-a1ce-b9e16426cbfb.png"},"flare_tag":{"name":"help","bg_color_hex":"#ff3232","text_color_hex":"#ffffff"}}